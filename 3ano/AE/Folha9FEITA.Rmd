---
title: "Exercícios – Inferência Estatística"
author: ""
output: html_document
fontsize: 11pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
set.seed(123)
```


# Exercício 1 – Estimação pontual e propriedades 

Considere uma amostra aleatória simples $X_1, \dots, X_n$ de uma população com média $\mu$ e variância $\sigma^2$ (desconhecidas).

Além das questões teóricas, utilize o R para trabalhar com o conjunto de dados abaixo, que representa, por exemplo, o número de horas de sono por noite de $n=12$ estudantes durante um período de exames.

```{r}
dados_ex1 <- c(6.5, 7.0, 5.8, 8.2, 6.9, 7.5, 5.2, 6.1, 7.8, 6.3, 5.9, 7.1)
dados_ex1
length(dados_ex1)  # tamanho da amostra


```

1. **Estimadores usuais**

   (a) Indique os estimadores usuais para:

   * a média populacional $\mu$ (denote por $\hat\mu$ ou $\bar X$);
   * a variância populacional $\sigma^2$ (denote por $S^2$).

   (b) Escreva as expressões explícitas de $\bar X$ e $S^2$ em função de $X_1,\dots,X_n$.

   (c) Usando o R e os dados `dados_ex1`, calcule a média amostral e a variância amostral.
```{r} 
#c) o a) e b) é escrever dos  pfs à mao
mediapop<- mean(dados_ex1)
varpop<- var(dados_ex1)
cat(mediapop,varpop)

```

   Compare verbalmente os valores obtidos com a definição de $\bar X$ e $S^2$ dada nas alíneas anteriores.

2. **Não-enviesado e consistência**

   (a) Explique, em palavras, o que significa dizer que um estimador $\hat\theta$ é **não-enviesado** para um parâmetro $\theta$.

   (b) Explique, em palavras, o que significa **consistência** de um estimador.

   (c) Com base nas suas respostas, comente, de forma qualitativa, por que razão a média amostral $\bar X$ é um estimador “natural” para a média populacional $\mu$.

   (d) Calcule, em R, o mínimo, máximo, média e desvio padrão dos valores em `dados_ex1`.

```{r}
#
#d) 
summary(dados_ex1)
sd(dados_ex1)
cat(summary(dados_ex1),sd(dados_ex1))

```
---

# Exercício 2 – Intervalos de confiança para a média

Uma empresa está interessada na duração (em horas) de baterias produzidas numa certa linha de fabrico. Assume-se que a duração das baterias é aproximadamente normal.

Foi recolhida uma amostra de $n = 20$ baterias, com resultados (em horas) guardados num ficheiro `baterias.csv`, numa coluna denominada `duracao`.

1. **Importação e estatísticas descritivas**

   (a) Importe os dados para o R e calcule a média amostral $\bar x$ e o desvio-padrão amostral $s$.
   
```{r}
medBat<-mean(baterias$duracao)
desvpad<-sd(baterias$duracao)
cat(medBat,desvpad)

```
   



2. **IC para $\mu$ com $\sigma$ desconhecida**

   (b) Admitindo que a variância populacional é **desconhecida**, construa um **intervalo de confiança a 95%** para a média duração $\mu$, assumindo normalidade.

   * Indique a estatística utilizada.
   * Refira qual a distribuição (t de Student) envolvida.
   * Apresente a fórmula do intervalo de confiança.

   (c) Calcule esse intervalo de confiança explicitamente usando o R (pode usar `t.test`).

```{r}
t.test(baterias, conf.level = 0.95)
#o veradeiro valor vai estar em 95% dos intrevalors que obtivermos, estatistica utilizada é a teste. d) tambem aqui

```
3. **Interpretação**

   (d) Interprete o intervalo de confiança obtido em linguagem simples.

   (e) Discuta o que aconteceria ao comprimento do intervalo se o tamanho amostral aumentasse (mantendo a mesma variabilidade). Justifique.

 o instrevao fica mais estreito 
---

# Exercício 3 – Intervalo de confiança e teste de hipótese para uma proporção

Num inquérito a **200 estudantes**, perguntou-se se utilizam transportes públicos para se deslocar até à escola.
Dos 200 estudantes, **90** responderam “Sim”.

1. **Estimador e intervalo de confiança**

   (a) Calcule a proporção amostral $\hat p$ de estudantes que utilizam transportes públicos.
   resposta : 90/200

   (b) Construa, usando uma aproximação normal, um **intervalo de confiança a 95%** para a proporção populacional $p$ de estudantes que usam transportes públicos.

   * Escreva a fórmula geral do IC para $p$.
   * Substitua os valores numéricos e apresente o intervalo.

   (c) Verifique o resultado usando a função `prop.test` no R (sem correcção de continuidade).

```{r}
#b) e c)
sucessos <- 90
n <- 200

prop.test(sucessos, n)$conf.int


```

2. **Teste de hipótese**

   (d) Suponha agora que se quer testar:

   $$
   H_0: p = 0.4 \quad \text{vs} \quad H_1: p \ne 0.4
   $$

   a nível de significância $\alpha = 0.05$.

   * Defina a estatística de teste aproximada (baseada na normal) e a sua distribuição sob $H_0$.
   * Calcule o valor observado da estatística de teste.
   * Calcule (ou obtenha no R) o $p$-valor.

   (e) Indique a sua decisão relativamente a $H_0$ e interprete o resultado no contexto do problema (usando linguagem acessível).
   
```{r}
x <- 90
n <- 200
p0 <- 0.4

prop.test(x, n, p = p0, alternative = "two.sided")

#Nao rejetiamos H0, p value é maior que alpha no caso 0.05, nao temos evidencia para dizer se a proporção de alunos que usa transportesp é diferente de 0.4.

```

---

# Exercício 4 – Inferência na regressão linear simples

Pretende-se estudar a relação entre o número de horas de estudo por semana ($X$) e a nota obtida num teste de Estatística ($Y$), numa turma de 30 alunos. Os dados foram guardados num ficheiro `estudo_notas.csv`, com duas colunas: `horas_estudo` e `nota`.

1. **Ajuste do modelo**

   (a) Importe os dados para o R e faça um gráfico de dispersão de `nota` versus `horas_estudo`.
   
```{r}
ggplot(estudo_notas, aes(x= horas_estudo, y= nota)) + geom_point()



```

   (b) Ajuste um modelo de **regressão linear simples**:

   $$
   Y = \beta_0 + \beta_1 X + \varepsilon
   $$

   usando a função `lm` do R, e apresente o resumo dos resultados.
```{r}
modelo1<-lm(nota~horas_estudo, data= estudo_notas)
summary(modelo1)
```

2. **Testes de hipótese sobre os coeficientes**

   (c) Considere o teste de hipótese:

   $$
   H_0: \beta_1 = 0 \quad \text{vs} \quad H_1: \beta_1 \ne 0.
   $$

   * Indique, em termos gerais, o que significa $H_0$ e o que significa $H_1$ neste contexto.
   * Usando a saída de `summary(mod)`, identifique o valor da estatística t para $\hat\beta_1$ e o respetivo $p$-valor.

   (d) A um nível de significância de 5%, qual é a sua conclusão relativamente a $H_0$?
   Interprete o resultado em linguagem simples.
```{r}
#H0 representa que nao existe uma regressao linear forte entre  x e y e H1 signiica que existe, como rejeitamos h0 tem significancia, horas de estudo explicam variabilidade das notas.





```
3. **Intervalo de confiança para o declive**

   (e) Construa um **intervalo de confiança a 95%** para $\beta_1$ usando o R.


   (f) Interprete o intervalo obtido:

   * O que significa dizer que o IC para $\beta_1$ é, por exemplo, `[0.3; 0.8]`?
   * Como relaciona essa interpretação com o teste de hipótese realizado anteriormente?

---
```{r}
confint(modelo1,level= 0.95)



```


```
::contentReference[oaicite:0]{index=0}
```
